<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:flowable="http://flowable.org/bpmn"
             xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
             xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI"
             typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath"
             targetNamespace="http://www.flowable.org/processdef">


    <!-- We expect a ${newOrderId} and ${order.email}
   -->
    <process id="ecomerce-test-example" name="ecommerce-test" isExecutable="true">
        <startEvent id="startEvent" flowable:initiator="initiator"></startEvent>
        <sequenceFlow id="flow-newOrder" sourceRef="startEvent" targetRef="newOrderTask"></sequenceFlow>
        <userTask id="newOrderTask" name="newOrderTask" flowable:assignee="${initiator}"></userTask>
        <sequenceFlow id="flow-payment-newOrder" sourceRef="newOrderTask"
                      targetRef="paymentReservationProcess"></sequenceFlow>
        <serviceTask id="paymentReservationProcess" name="paymentReservation"
                     flowable:expression="${paymentService.verifyPayment(orderId, orderEmail)}"></serviceTask>

        <sequenceFlow id="flow-end" sourceRef="paymentReservationProcess"
                      targetRef="end"></sequenceFlow>

        <endEvent id="end"></endEvent>
    </process>



</definitions>